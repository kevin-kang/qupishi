require(["module/util","module/getMore"],function(t,e){var i=($(document),$(window),$(".city_area_items")),n=$(".top_bar_ok"),c=$("#template"),a=t.query("country_code")||"th",r=decodeURIComponent(t.query("country_name_cn"))||"泰国",o=sessionStorage.getItem("qsdetail"),s=JSON.parse(localStorage.getItem("www.tripsters.cn")),u=s.id,l=c.html(),d=0,p=[];e({url:"http://www.tripsters.cn/index.php?a=getCity&c=index&m=country",data:{country_code:a},cb:function(e){"OK"==e.retcode&&e.city&&(e.city.forEach(function(e){p.push(t.tmpl(l,e))}),i.html(p.join("")))}}),i.on("click","li",function(){var t=$(this);t.find(".city_area_r_input").hasClass("active")?(d=-1==d?0:--d,t.find(".city_area_r_input").toggleClass("active")):3>d&&!t.find(".city_area_r_input").hasClass("active")&&(t.find(".city_area_r_input").toggleClass("active"),++d)}),n.on("click",function(){var n={a:"sendQuestion",c:"index",m:"answer",user_id:u,city:[],title:o,country:r,platform:"weixinplatform"};return i.find(".active").length&&i.find(".active").each(function(){n.city.push($(this).parent().siblings().html())}),n.city=n.city.toString(),t.isNull(n.city)?(alert("城市必选！"),!1):void e({url:"http://www.tripsters.cn/index.php",dataType:"jsonp",data:n,cb:function(t){"true"==t.retcode&&(alert("提问成功"),location.href="所有问题.html?country_code="+a+"&country_name_cn="+r)}})})});